---
import { getEntry } from "astro:content";
import Button from "./user-components/Button.astro";
import Section from "./Section.astro";
import ImageMod from "./ImageMod.astro";

const locale = Astro.currentLocale || "en";

const cta = await getEntry(
  "ctaSection",
  `${locale === "en" ? "" : `${locale}/`}call-to-action`
);
const { title, description, enable, fill_button, outline_button } =
  cta?.data ?? {};
---

{
  enable && (
    <div class="cta-container">
      <div class="hero-bg">
        <ImageMod
          src="/src/assets/hero-bg-dark.png"
          alt="CTA Background Dark"
          class="hidden dark:block object-cover w-full h-full"
          loading="eager"
          width={1920}
          height={820}
          fetchpriority="high"
        />
      </div>
      <Section title={title} description={description}>
        {fill_button?.enable && (
          <Button
            label={fill_button.label || "Book A Free 15-Min Clarity Call"}
            link={fill_button.link || "https://tidycal.com/rajavanya/15-min-clarity-call"}
            variant="primary"
          />
        )}
        {outline_button?.enable && (
          <Button
            label={outline_button.label || "See My Services"}
            link={
              outline_button.link || "/my-services/"
            }
            variant="outline-primary"
          />
        )}
      </Section>
    </div>
  )
}

<style>
  /* Ensure background image is visible in light mode */
  :global([data-theme="light"]) .cta-container {
    background-blend-mode: multiply;
    background-color: #f9fafb; /* Light background color */
  }

  /* Dark mode styling */
  :global([data-theme="dark"]) .cta-container {
    /* background: url("/src/assets/hero-bg-dark.png") no-repeat center;
    background-size: cover; */
    padding: 1rem;
    position: relative;
  }


</style>

<script>
  const ctaContainerButton = document.querySelector(".cta-container a");

  const buttonParent = ctaContainerButton?.parentElement;

  if (buttonParent) {
    buttonParent.style.display = "flex";
    buttonParent.style.justifyContent = "center";
    buttonParent.style.gap = "1rem";
  }
</script>
